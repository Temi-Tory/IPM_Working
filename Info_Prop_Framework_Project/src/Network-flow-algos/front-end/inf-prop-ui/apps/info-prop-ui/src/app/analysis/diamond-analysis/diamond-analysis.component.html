<div class="diamond-analysis-container">
  
  <!-- Header Section -->
  <div class="analysis-header">
    <div class="header-content">
      <div class="header-info">
        <h1><mat-icon>diamond</mat-icon> Diamond Structure Analysis</h1>
        <p class="network-name">{{ componentData()?.structure?.networkName || 'Network' }}</p>
        <div class="header-stats">
          <span class="stat-badge">{{ getRootDiamondsCount() }} Root Diamonds</span>
          <span class="stat-badge">{{ getUniqueDiamondsCount() }} Unique Structures</span>
          <span class="stat-badge">{{ getFormattedEfficiency() }} Efficiency</span>
        </div>
      </div>
      
      <div class="header-actions">
        <app-analysis-view-switcher 
          [currentMode]="currentViewMode()"
          [availableModes]="availableViewModes()"
          (modeChange)="switchViewMode($event)">
        </app-analysis-view-switcher>
        
        <button mat-button [matMenuTriggerFor]="exportMenu">
          <mat-icon>download</mat-icon>
          Export
        </button>
        
        <mat-menu #exportMenu="matMenu">
          <button mat-menu-item (click)="exportData('json')">
            <mat-icon>code</mat-icon>
            <span>Export JSON</span>
          </button>
          <button mat-menu-item (click)="exportData('csv')">
            <mat-icon>table_chart</mat-icon>
            <span>Export CSV</span>
          </button>
        </mat-menu>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  @if (isLoading()) {
    <div class="loading-container">
      <mat-spinner></mat-spinner>
      <p>Analyzing diamond structures...</p>
    </div>
  }

  <!-- Error State -->
  @if (error()) {
    <mat-card class="error-card">
      <mat-card-content>
        <div class="error-content">
          <mat-icon class="error-icon">error</mat-icon>
          <div>
            <h3>Diamond Analysis Error</h3>
            <p>{{ error() }}</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  }

  <!-- Main Content -->
  @if (!isLoading() && !error() && componentData()) {
    
    <!-- Visual Mode - Diamond Structure Details -->
    @if (isVisualMode()) {
      <div class="visual-mode">
        
        <!-- Diamond Inventory Summary -->
        <div class="diamond-summary-section">
          <mat-card class="diamond-summary-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>inventory</mat-icon>
                Diamond Inventory
              </mat-card-title>
              <mat-card-subtitle>{{ getTotalClassifications() }} unique diamond structures detected</mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>
              <div class="summary-stats">
                <div class="stat-item primary">
                  <div class="stat-value">{{ getRootDiamondsCount() }}</div>
                  <div class="stat-label">Root Diamonds</div>
                </div>
                <div class="stat-item secondary">
                  <div class="stat-value">{{ getUniqueDiamondsCount() }}</div>
                  <div class="stat-label">Unique Diamonds</div>
                </div>
                <div class="stat-item accent">
                  <div class="stat-value">{{ getFormattedEfficiency() }}</div>
                  <div class="stat-label">Diamond Efficiency</div>
                </div>
                <div class="stat-item" [class.warning]="getHasComplexDiamonds()">
                  <div class="stat-value">{{ getHasComplexDiamonds() ? 'Yes' : 'No' }}</div>
                  <div class="stat-label">Complex Structures</div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>
        </div>

        <!-- Diamond Structure Details -->
        <div class="diamond-details-section">
          <mat-card class="diamond-details-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>account_tree</mat-icon>
                Diamond Structure Details
              </mat-card-title>
              <mat-card-subtitle>Detailed analysis of each diamond structure with classification</mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>
              <mat-accordion class="diamond-accordion" multi="true">
                
                <!-- Root Diamonds -->
                @if (getRootClassifications() | keyvalue; as rootDiamonds) {
                  @for (diamond of rootDiamonds; track diamond.key) {
                    <mat-expansion-panel class="diamond-panel root-diamond">
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          <div class="diamond-title">
                            <mat-icon class="diamond-type-icon">diamond</mat-icon>
                            <span>Root Diamond {{ diamond.key }}</span>
                            @if (getDiamondClassification(diamond.value)?.is_maximal) {
                              <mat-chip class="maximal-chip">Maximal</mat-chip>
                            } @else {
                              <mat-chip class="unique-chip">Unique</mat-chip>
                            }
                          </div>
                        </mat-panel-title>
                        <mat-panel-description>
                          <div class="diamond-summary">
                            <span class="summary-item">
                              <mat-icon>account_tree</mat-icon>
                              {{ getDiamondClassification(diamond.value)?.edge_count || 0 }} edges
                            </span>
                            <span class="summary-item">
                              <mat-icon>hub</mat-icon>
                              {{ getDiamondClassification(diamond.value)?.conditioning_nodes?.length || 0 }} conditioning nodes
                            </span>
                            <span class="summary-item">
                              <mat-icon>speed</mat-icon>
                              {{ getDiamondClassification(diamond.value)?.complexity_score || 0 | number:'1.1-1' }} complexity
                            </span>
                          </div>
                        </mat-panel-description>
                      </mat-expansion-panel-header>
                      
                      <div class="diamond-detail-content">
                        <div class="diamond-info-tabs">
                          <mat-tab-group>
                            <!-- Structure Tab -->
                            <mat-tab label="Structure">
                              <div class="structure-info">
                                <div class="info-grid">
                                  <div class="info-section">
                                    <h4><mat-icon>hub</mat-icon> Node Information</h4>
                                    <div class="node-lists">
                                      <div class="node-list-item">
                                        <span class="label">Relevant Nodes:</span>
                                        <div class="nodes-container">
                                          <mat-chip-set>
                                            @for (node of getDiamondClassification(diamond.value)?.relevant_nodes || []; track node) {
                                              <mat-chip class="node-chip relevant">{{ node }}</mat-chip>
                                            }
                                          </mat-chip-set>
                                        </div>
                                      </div>
                                      <div class="node-list-item">
                                        <span class="label">Conditioning Nodes:</span>
                                        <div class="nodes-container">
                                          <mat-chip-set>
                                            @for (node of getDiamondClassification(diamond.value)?.conditioning_nodes || []; track node) {
                                              <mat-chip class="node-chip conditioning">{{ node }}</mat-chip>
                                            }
                                          </mat-chip-set>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                  
                                  <div class="info-section">
                                    <h4><mat-icon>analytics</mat-icon> Metrics</h4>
                                    <div class="metrics-grid">
                                      <div class="metric-item">
                                        <span class="metric-label">Edge Count:</span>
                                        <span class="metric-value">{{ getDiamondClassification(diamond.value)?.edge_count || 0 }}</span>
                                      </div>
                                      <div class="metric-item">
                                        <span class="metric-label">Fork Count:</span>
                                        <span class="metric-value">{{ getDiamondClassification(diamond.value)?.fork_count || 0 }}</span>
                                      </div>
                                      <div class="metric-item">
                                        <span class="metric-label">Subgraph Size:</span>
                                        <span class="metric-value">{{ getDiamondClassification(diamond.value)?.subgraph_size || 0 }}</span>
                                      </div>
                                      <div class="metric-item">
                                        <span class="metric-label">Internal Forks:</span>
                                        <span class="metric-value">{{ getDiamondClassification(diamond.value)?.internal_forks || 0 }}</span>
                                      </div>
                                      <div class="metric-item">
                                        <span class="metric-label">Internal Joins:</span>
                                        <span class="metric-value">{{ getDiamondClassification(diamond.value)?.internal_joins || 0 }}</span>
                                      </div>
                                      <div class="metric-item">
                                        <span class="metric-label">Path Count:</span>
                                        <span class="metric-value">{{ getDiamondClassification(diamond.value)?.path_count || 0 }}</span>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </mat-tab>

                            <!-- Classification Tab -->
                            <mat-tab label="Classification">
                              <div class="classification-info">
                                <div class="classification-grid">
                                  <div class="classification-category">
                                    <h4><mat-icon>category</mat-icon> Structural Classification</h4>
                                    <div class="classification-items">
                                      <div class="classification-item">
                                        <span class="classification-label">Fork Structure:</span>
                                        <mat-chip class="classification-chip fork-structure">{{ getDiamondClassification(diamond.value)?.fork_structure || 'Unknown' }}</mat-chip>
                                      </div>
                                      <div class="classification-item">
                                        <span class="classification-label">Internal Structure:</span>
                                        <mat-chip class="classification-chip internal-structure">{{ getDiamondClassification(diamond.value)?.internal_structure || 'Unknown' }}</mat-chip>
                                      </div>
                                      <div class="classification-item">
                                        <span class="classification-label">Path Topology:</span>
                                        <mat-chip class="classification-chip path-topology">{{ getDiamondClassification(diamond.value)?.path_topology || 'Unknown' }}</mat-chip>
                                      </div>
                                      <div class="classification-item">
                                        <span class="classification-label">Join Structure:</span>
                                        <mat-chip class="classification-chip join-structure">{{ getDiamondClassification(diamond.value)?.join_structure || 'Unknown' }}</mat-chip>
                                      </div>
                                      <div class="classification-item">
                                        <span class="classification-label">External Connectivity:</span>
                                        <mat-chip class="classification-chip external-connectivity">{{ getDiamondClassification(diamond.value)?.external_connectivity || 'Unknown' }}</mat-chip>
                                      </div>
                                      <div class="classification-item">
                                        <span class="classification-label">Degeneracy:</span>
                                        <mat-chip class="classification-chip degeneracy" [class.valid]="getDiamondClassification(diamond.value)?.degeneracy === 'VALID'">{{ getDiamondClassification(diamond.value)?.degeneracy || 'Unknown' }}</mat-chip>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </mat-tab>

                            <!-- Performance Tab -->
                            <mat-tab label="Performance">
                              <div class="performance-info">
                                <div class="performance-grid">
                                  <div class="performance-section">
                                    <h4><mat-icon>speed</mat-icon> Performance Metrics</h4>
                                    <div class="performance-items">
                                      <div class="performance-item">
                                        <span class="performance-label">Complexity Score:</span>
                                        <div class="performance-value-container">
                                          <span class="performance-value">{{ getDiamondClassification(diamond.value)?.complexity_score || 0 | number:'1.2-2' }}</span>
                                          <div class="complexity-bar">
                                            <div class="complexity-fill" [style.width.%]="getComplexityPercentage(getDiamondClassification(diamond.value)?.complexity_score || 0)"></div>
                                          </div>
                                        </div>
                                      </div>
                                      <div class="performance-item">
                                        <span class="performance-label">Optimization Potential:</span>
                                        <mat-chip [class]="getOptimizationClass(getDiamondClassification(diamond.value)?.optimization_potential)">{{ getDiamondClassification(diamond.value)?.optimization_potential || 'Unknown' }}</mat-chip>
                                      </div>
                                      <div class="performance-item">
                                        <span class="performance-label">Bottleneck Risk:</span>
                                        <mat-chip [class]="getBottleneckClass(getDiamondClassification(diamond.value)?.bottleneck_risk)">{{ getDiamondClassification(diamond.value)?.bottleneck_risk || 'Unknown' }}</mat-chip>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </mat-tab>
                          </mat-tab-group>
                        </div>
                      </div>
                    </mat-expansion-panel>
                  }
                }

                <!-- Unique Diamonds -->
                @if (getUniqueClassifications() | keyvalue; as uniqueDiamonds) {
                  @for (diamond of uniqueDiamonds; track diamond.key) {
                    <mat-expansion-panel class="diamond-panel unique-diamond">
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          <div class="diamond-title">
                            <mat-icon class="diamond-type-icon">crop_free</mat-icon>
                            <span>Unique Diamond {{ diamond.key }}</span>
                            <mat-chip class="unique-chip">Unique</mat-chip>
                          </div>
                        </mat-panel-title>
                        <mat-panel-description>
                          <div class="diamond-summary">
                            <span class="summary-item">
                              <mat-icon>account_tree</mat-icon>
                              {{ getDiamondClassification(diamond.value)?.edge_count || 0 }} edges
                            </span>
                            <span class="summary-item">
                              <mat-icon>hub</mat-icon>
                              {{ getDiamondClassification(diamond.value)?.conditioning_nodes?.length || 0 }} conditioning nodes
                            </span>
                            <span class="summary-item">
                              <mat-icon>speed</mat-icon>
                              {{ getDiamondClassification(diamond.value)?.complexity_score || 0 | number:'1.1-1' }} complexity
                            </span>
                          </div>
                        </mat-panel-description>
                      </mat-expansion-panel-header>
                      
                      <!-- Same detailed content structure as root diamonds -->
                      <div class="diamond-detail-content">
                        <div class="diamond-info-tabs">
                          <mat-tab-group>
                            <mat-tab label="Structure">
                              <!-- Same structure content as root diamonds -->
                              <div class="structure-info">
                                <div class="info-grid">
                                  <div class="info-section">
                                    <h4><mat-icon>hub</mat-icon> Node Information</h4>
                                    <div class="node-lists">
                                      <div class="node-list-item">
                                        <span class="label">Relevant Nodes:</span>
                                        <div class="nodes-container">
                                          <mat-chip-set>
                                            @for (node of getDiamondClassification(diamond.value)?.relevant_nodes || []; track node) {
                                              <mat-chip class="node-chip relevant">{{ node }}</mat-chip>
                                            }
                                          </mat-chip-set>
                                        </div>
                                      </div>
                                      <div class="node-list-item">
                                        <span class="label">Conditioning Nodes:</span>
                                        <div class="nodes-container">
                                          <mat-chip-set>
                                            @for (node of getDiamondClassification(diamond.value)?.conditioning_nodes || []; track node) {
                                              <mat-chip class="node-chip conditioning">{{ node }}</mat-chip>
                                            }
                                          </mat-chip-set>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                  
                                  <div class="info-section">
                                    <h4><mat-icon>analytics</mat-icon> Metrics</h4>
                                    <div class="metrics-grid">
                                      <div class="metric-item">
                                        <span class="metric-label">Edge Count:</span>
                                        <span class="metric-value">{{ getDiamondClassification(diamond.value)?.edge_count || 0 }}</span>
                                      </div>
                                      <div class="metric-item">
                                        <span class="metric-label">Fork Count:</span>
                                        <span class="metric-value">{{ getDiamondClassification(diamond.value)?.fork_count || 0 }}</span>
                                      </div>
                                      <div class="metric-item">
                                        <span class="metric-label">Subgraph Size:</span>
                                        <span class="metric-value">{{ getDiamondClassification(diamond.value)?.subgraph_size || 0 }}</span>
                                      </div>
                                      <div class="metric-item">
                                        <span class="metric-label">Internal Forks:</span>
                                        <span class="metric-value">{{ getDiamondClassification(diamond.value)?.internal_forks || 0 }}</span>
                                      </div>
                                      <div class="metric-item">
                                        <span class="metric-label">Internal Joins:</span>
                                        <span class="metric-value">{{ getDiamondClassification(diamond.value)?.internal_joins || 0 }}</span>
                                      </div>
                                      <div class="metric-item">
                                        <span class="metric-label">Path Count:</span>
                                        <span class="metric-value">{{ getDiamondClassification(diamond.value)?.path_count || 0 }}</span>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </mat-tab>
                            <mat-tab label="Classification">
                              <!-- Same classification content -->
                              <div class="classification-info">
                                <div class="classification-grid">
                                  <div class="classification-category">
                                    <h4><mat-icon>category</mat-icon> Structural Classification</h4>
                                    <div class="classification-items">
                                      <div class="classification-item">
                                        <span class="classification-label">Fork Structure:</span>
                                        <mat-chip class="classification-chip fork-structure">{{ getDiamondClassification(diamond.value)?.fork_structure || 'Unknown' }}</mat-chip>
                                      </div>
                                      <div class="classification-item">
                                        <span class="classification-label">Internal Structure:</span>
                                        <mat-chip class="classification-chip internal-structure">{{ getDiamondClassification(diamond.value)?.internal_structure || 'Unknown' }}</mat-chip>
                                      </div>
                                      <div class="classification-item">
                                        <span class="classification-label">Path Topology:</span>
                                        <mat-chip class="classification-chip path-topology">{{ getDiamondClassification(diamond.value)?.path_topology || 'Unknown' }}</mat-chip>
                                      </div>
                                      <div class="classification-item">
                                        <span class="classification-label">Join Structure:</span>
                                        <mat-chip class="classification-chip join-structure">{{ getDiamondClassification(diamond.value)?.join_structure || 'Unknown' }}</mat-chip>
                                      </div>
                                      <div class="classification-item">
                                        <span class="classification-label">External Connectivity:</span>
                                        <mat-chip class="classification-chip external-connectivity">{{ getDiamondClassification(diamond.value)?.external_connectivity || 'Unknown' }}</mat-chip>
                                      </div>
                                      <div class="classification-item">
                                        <span class="classification-label">Degeneracy:</span>
                                        <mat-chip class="classification-chip degeneracy" [class.valid]="getDiamondClassification(diamond.value)?.degeneracy === 'VALID'">{{ getDiamondClassification(diamond.value)?.degeneracy || 'Unknown' }}</mat-chip>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </mat-tab>
                            <mat-tab label="Performance">
                              <!-- Same performance content -->
                              <div class="performance-info">
                                <div class="performance-grid">
                                  <div class="performance-section">
                                    <h4><mat-icon>speed</mat-icon> Performance Metrics</h4>
                                    <div class="performance-items">
                                      <div class="performance-item">
                                        <span class="performance-label">Complexity Score:</span>
                                        <div class="performance-value-container">
                                          <span class="performance-value">{{ getDiamondClassification(diamond.value)?.complexity_score || 0 | number:'1.2-2' }}</span>
                                          <div class="complexity-bar">
                                            <div class="complexity-fill" [style.width.%]="getComplexityPercentage(getDiamondClassification(diamond.value)?.complexity_score || 0)"></div>
                                          </div>
                                        </div>
                                      </div>
                                      <div class="performance-item">
                                        <span class="performance-label">Optimization Potential:</span>
                                        <mat-chip [class]="getOptimizationClass(getDiamondClassification(diamond.value)?.optimization_potential)">{{ getDiamondClassification(diamond.value)?.optimization_potential || 'Unknown' }}</mat-chip>
                                      </div>
                                      <div class="performance-item">
                                        <span class="performance-label">Bottleneck Risk:</span>
                                        <mat-chip [class]="getBottleneckClass(getDiamondClassification(diamond.value)?.bottleneck_risk)">{{ getDiamondClassification(diamond.value)?.bottleneck_risk || 'Unknown' }}</mat-chip>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </mat-tab>
                          </mat-tab-group>
                        </div>
                      </div>
                    </mat-expansion-panel>
                  }
                }

                @if (getTotalClassifications() === 0) {
                  <div class="no-diamonds-message">
                    <mat-icon>info</mat-icon>
                    <h3>No Diamond Structures Found</h3>
                    <p>The network analysis did not detect any diamond structures. This could indicate a simpler network topology or specific structural characteristics.</p>
                  </div>
                }
              </mat-accordion>
            </mat-card-content>
          </mat-card>
        </div>
      </div>
    }

    <!-- Dashboard Mode - High-Level Overview -->
    @if (isDashboardMode()) {
      <div class="dashboard-mode">
        
        <!-- Executive Summary -->
        <div class="executive-summary">
          <mat-card class="executive-summary-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>summarize</mat-icon>
                Diamond Analysis Executive Summary
              </mat-card-title>
              <mat-card-subtitle>{{ getNetworkName() }} - Structural Analysis Overview</mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>
              <div class="summary-content">
                <p class="summary-text">
                  Analysis identified <strong>{{ getTotalClassifications() }} diamond structures</strong> in the network, 
                  including <strong>{{ getRootDiamondsCount() }} root diamonds</strong> and 
                  <strong>{{ getUniqueDiamondsCount() }} unique diamonds</strong>.
                  @if (getHasComplexDiamonds()) {
                    Complex diamond patterns indicate sophisticated network topology with advanced structural relationships.
                  } @else {
                    The network exhibits relatively straightforward diamond patterns with standard structural characteristics.
                  }
                </p>
                <div class="key-findings">
                  <h4><mat-icon>lightbulb</mat-icon> Key Findings</h4>
                  <ul class="findings-list">
                    <li>Diamond efficiency: <strong>{{ getFormattedEfficiency() }}</strong></li>
                    <li>Join nodes with diamonds: <strong>{{ getJoinNodesWithDiamonds().length }}</strong></li>
                    <li>Structural complexity: <strong>{{ getHasComplexDiamonds() ? 'High - Advanced patterns detected' : 'Standard - Typical diamond structures' }}</strong></li>
                    <li>Network coverage: <strong>{{ getDiamondCoverage() }}%</strong> of join nodes contain diamonds</li>
                  </ul>
                </div>
              </div>
            </mat-card-content>
          </mat-card>
        </div>

        <!-- Dashboard Grid -->
        <div class="dashboard-grid">
          <!-- Classification Overview -->
          <mat-card class="dashboard-card classification-overview">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>category</mat-icon>
                Structural Classification Overview
              </mat-card-title>
            </mat-card-header>
            <mat-card-content>
              <div class="classification-summary">
                <div class="classification-stats">
                  <div class="classification-stat">
                    <div class="stat-icon"><mat-icon>fork_right</mat-icon></div>
                    <div class="stat-info">
                      <div class="stat-label">Fork Structures</div>
                      <div class="stat-value">{{ getStructureTypeCount('fork') }}</div>
                      <div class="stat-detail">Different fork patterns</div>
                    </div>
                  </div>
                  <div class="classification-stat">
                    <div class="stat-icon"><mat-icon>timeline</mat-icon></div>
                    <div class="stat-info">
                      <div class="stat-label">Path Topologies</div>
                      <div class="stat-value">{{ getStructureTypeCount('path') }}</div>
                      <div class="stat-detail">Path organization patterns</div>
                    </div>
                  </div>
                  <div class="classification-stat">
                    <div class="stat-icon"><mat-icon>architecture</mat-icon></div>
                    <div class="stat-info">
                      <div class="stat-label">Internal Structures</div>
                      <div class="stat-value">{{ getStructureTypeCount('internal') }}</div>
                      <div class="stat-detail">Internal organization types</div>
                    </div>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Performance Analysis -->
          <mat-card class="dashboard-card performance-analysis">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>speed</mat-icon>
                Performance & Optimization Analysis
              </mat-card-title>
            </mat-card-header>
            <mat-card-content>
              <div class="performance-overview">
                <div class="performance-metrics">
                  <div class="performance-metric high-optimization">
                    <div class="metric-icon"><mat-icon>trending_up</mat-icon></div>
                    <div class="metric-info">
                      <div class="metric-value">{{ getOptimizationPotentialCount('High') }}</div>
                      <div class="metric-label">High Optimization Potential</div>
                    </div>
                  </div>
                  <div class="performance-metric medium-risk">
                    <div class="metric-icon"><mat-icon>warning</mat-icon></div>
                    <div class="metric-info">
                      <div class="metric-value">{{ getBottleneckRiskCount('Medium') }}</div>
                      <div class="metric-label">Medium Bottleneck Risk</div>
                    </div>
                  </div>
                  <div class="performance-metric high-risk">
                    <div class="metric-icon"><mat-icon>error</mat-icon></div>
                    <div class="metric-info">
                      <div class="metric-value">{{ getBottleneckRiskCount('High') }}</div>
                      <div class="metric-label">High Bottleneck Risk</div>
                    </div>
                  </div>
                </div>
                <div class="complexity-overview">
                  <div class="complexity-info">
                    <span class="complexity-label">Average Complexity:</span>
                    <span class="complexity-value">{{ getAverageComplexity() | number:'1.1-1' }}</span>
                  </div>
                  <div class="complexity-bar-container">
                    <div class="complexity-bar">
                      <div class="complexity-fill" [style.width.%]="getComplexityPercentage(getAverageComplexity())"></div>
                    </div>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Network Impact -->
          <mat-card class="dashboard-card network-impact">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>hub</mat-icon>
                Network Impact Analysis
              </mat-card-title>
            </mat-card-header>
            <mat-card-content>
              <div class="impact-analysis">
                <div class="impact-metrics">
                  <div class="impact-metric">
                    <div class="impact-label">Diamond Coverage</div>
                    <div class="impact-value">{{ getDiamondCoverage() }}%</div>
                    <div class="impact-detail">of join nodes contain diamonds</div>
                  </div>
                  <div class="impact-metric">
                    <div class="impact-label">Critical Diamonds</div>
                    <div class="impact-value">{{ getCriticalDiamondsCount() }}</div>
                    <div class="impact-detail">high-impact structures</div>
                  </div>
                  <div class="impact-metric">
                    <div class="impact-label">Efficiency Score</div>
                    <div class="impact-value">{{ getFormattedEfficiency() }}</div>
                    <div class="impact-detail">overall diamond efficiency</div>
                  </div>
                </div>
                <div class="action-buttons">
                  <button mat-raised-button color="primary" (click)="highlightJoinNodes()">
                    <mat-icon>highlight</mat-icon>
                    Highlight Join Nodes
                  </button>
                  <button mat-raised-button color="accent" (click)="highlightCriticalDiamonds()">
                    <mat-icon>priority_high</mat-icon>
                    Highlight Critical Diamonds
                  </button>
                </div>
              </div>
            </mat-card-content>
          </mat-card>
        </div>
      </div>
    }
  }
</div>